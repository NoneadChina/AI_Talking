<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹“å¾·AIè®¨è®ºè¾©è®ºç³»ç»Ÿ - NONEAD Corporation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
    
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .logo {
            max-width: 200px;
            margin-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tab-button {
            flex: 1;
            padding: 15px;
            text-align: center;
            border: none;
            background-color: #f8f9fa;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 16px;
        }
        
        .tab-button.active {
            background-color: #007bff;
            color: white;
        }
        
        .tab-button:hover:not(.active) {
            background-color: #e9ecef;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input[type="text"],
        input[type="password"],
        select,
        textarea,
        input[type="number"],
        input[type="range"] {
            width: 100%;
            padding: 10px;
        }
        
        /* æ¨¡å‹åˆ—è¡¨æ ·å¼ */
        .models-list {
            margin-top: 10px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            min-height: 100px;
        }
        
        .models-list ul {
            list-style-type: none;
            padding: 0;
        }
        
        .models-list li {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .models-list li:last-child {
            border-bottom: none;
        }
        
        .models-list .loading {
            text-align: center;
            color: #6c757d;
            font-style: italic;
        }
        
        .models-list .no-models {
            text-align: center;
            color: #6c757d;
        }
        
        .models-list .error {
            text-align: center;
            color: #dc3545;
            font-weight: 500;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 10px;
        }
        
        .btn-secondary:hover {
             background-color: #5a6268;
         }
        
        input[type="text"],
        input[type="password"],
        select,
        textarea,
        input[type="number"],
        input[type="range"] {
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .config-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .config-col {
            flex: 1;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0056b3;
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .chat-history {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fafafa;
        }
        
        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .message-ai1 {
            border-left: 4px solid #007bff;
        }
        
        .message-ai2 {
            border-left: 4px solid #28a745;
        }
        
        .message-header {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .message-ai1 .message-header {
            color: #007bff;
        }
        
        .message-ai2 .message-header {
            color: #28a745;
        }
        
        .message-content {
            white-space: pre-wrap;
        }
        
        .status-bar {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .params-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .param-control {
            display: flex;
            flex-direction: column;
        }
        
        .param-control label {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .param-control input[type="range"] {
            margin-bottom: 5px;
        }
        
        .param-value {
            text-align: center;
            font-size: 14px;
            color: #666;
        }
        
        .api-settings {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .api-group {
            margin-bottom: 25px;
        }
        
        .api-group h3 {
            margin-bottom: 15px;
            color: #495057;
        }
        
        .show-key {
            margin-top: 5px;
            font-size: 12px;
            cursor: pointer;
            color: #007bff;
            text-align: right;
        }
        
        .show-key:hover {
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            .config-row {
                flex-direction: column;
            }
            
            .params-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div id="loginModal" class="modal" style="display: block; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
        <div class="modal-content" style="background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 300px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
            <h2 style="text-align: center; margin-bottom: 20px;">ç”¨æˆ·ç™»å½•</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginUsername">ç”¨æˆ·å</label>
                    <input type="text" id="loginUsername" required style="width: 100%; padding: 8px; margin: 8px 0; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div class="form-group">
                    <label for="loginPassword">å¯†ç </label>
                    <input type="password" id="loginPassword" required style="width: 100%; padding: 8px; margin: 8px 0; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div class="form-group">
                    <button type="submit" style="width: 100%; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">ç™»å½•</button>
                </div>
                <div class="form-group" style="margin-top: 10px; text-align: center;">
                    <button type="button" id="registerBtn" style="background: none; border: none; color: #007bff; cursor: pointer;">æ³¨å†Œæ–°ç”¨æˆ·</button>
                </div>
                <div id="loginError" style="color: red; text-align: center; margin-top: 10px;"></div>
            </form>
        </div>
    </div>

    <div class="container">
        <header>
            <img src="https://www.nonead.com/assets/img/vi/NONEAD_ai.png" alt="NONEAD AI Logo" class="logo">
            <h1>AIå¯¹è¯ç³»ç»Ÿ</h1>
        </header>
        
        <div class="tabs">
            <button class="tab-button" onclick="switchTab('human-chat-tab', event)">èŠå¤©</button>
            <button class="tab-button active" onclick="switchTab('chat-tab', event)">è®¨è®º</button>
            <button class="tab-button" onclick="switchTab('debate-tab', event)">è¾©è®º</button>
            <button class="tab-button" onclick="switchTab('batch-tab', event)">æ‰¹é‡</button>
            <button class="tab-button" onclick="switchTab('settings-tab', event)">è®¾ç½®</button>
            <button class="tab-button" onclick="switchTab('history-tab', event)">å†å²ç®¡ç†</button>
            <button class="tab-button" onclick="switchTab('about-tab', event)">å…³äº</button>
        </div>
        
        <div id="chat-tab" class="tab-content active">
            <div class="form-group">
                <label for="topic">è®¨è®ºä¸»é¢˜</label>
                <input type="text" id="topic" placeholder="è¯·è¾“å…¥è®¨è®ºä¸»é¢˜">
            </div>
            
            <div class="config-row">
                <div class="config-col">
                    <h3>è®¨è®ºAI1</h3>
                    <div class="form-group">
                        <label for="api1">æ¨¡å‹æœåŠ¡å•†</label>
                        <select id="api1">
                            <option value="ollama">ollama</option>
                            <option value="openai">openai</option>
                            <option value="deepseek">deepseek</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="model1">æ¨¡å‹</label>
                        <select id="model1">
                            <option value="qwen3:14b">qwen3:14b</option>
                            <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                            <option value="gpt-4">gpt-4</option>
                            <option value="deepseek-chat">deepseek-chat</option>
                            <option value="llama2">llama2</option>
                            <option value="mistral">mistral</option>
                            <option value="gemma">gemma</option>
                        </select>
                    </div>
                </div>
                
                <div class="config-col">
                    <h3>è®¨è®ºAI2</h3>
                    <div class="form-group">
                        <label for="api2">æ¨¡å‹æœåŠ¡å•†</label>
                        <select id="api2">
                            <option value="ollama">ollama</option>
                            <option value="openai">openai</option>
                            <option value="deepseek">deepseek</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="model2">æ¨¡å‹</label>
                        <select id="model2">
                            <option value="deepseek-r1:14b">deepseek-r1:14b</option>
                            <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                            <option value="gpt-4">gpt-4</option>
                            <option value="deepseek-chat">deepseek-chat</option>
                            <option value="llama2">llama2</option>
                            <option value="mistral">mistral</option>
                            <option value="gemma">gemma</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="params-grid">
                <div class="param-control">
                    <label for="rounds">è®¨è®ºè½®æ•°</label>
                    <input type="range" id="rounds" min="1" max="20" value="5" oninput="document.getElementById('rounds-value').textContent = this.value">
                    <span id="rounds-value" class="param-value">5</span>
                </div>
                
                <div class="param-control">
                    <label for="timeLimit">æ—¶é—´é™åˆ¶(ç§’)</label>
                    <input type="range" id="timeLimit" min="0" max="3600" step="30" value="0" oninput="document.getElementById('timeLimit-value').textContent = this.value === '0' ? 'æ— é™åˆ¶' : this.value">
                    <span id="timeLimit-value" class="param-value">æ— é™åˆ¶</span>
                </div>
                
                <div class="param-control">
                    <label for="temperature">æ¸©åº¦</label>
                    <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.8" oninput="document.getElementById('temperature-value').textContent = this.value">
                    <span id="temperature-value" class="param-value">0.8</span>
                </div>
            </div>
            
            <div class="status-bar" id="status">å°±ç»ª</div>
            
            <div class="chat-history" id="chatHistory"></div>
            
            <div class="button-group">
                <button id="exportPdf" class="btn-secondary">å¯¼å‡ºPDF</button>
                <button id="startChat" class="btn-primary">å¼€å§‹è®¨è®º</button>
                <button id="stopChat" class="btn-danger" disabled>åœæ­¢è®¨è®º</button>
            </div>
        </div>
        
        <div id="human-chat-tab" class="tab-content">
            <!-- èŠå¤©é…ç½®åŒºåŸŸ -->
            <div class="chat-config-group" style="background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #e9ecef;">
                <h3 style="margin-top: 0; margin-bottom: 15px;">èŠå¤©é…ç½®</h3>
                <div class="config-row" style="display: flex; gap: 15px; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label for="human-provider" style="margin: 0;">API:</label>
                        <select id="human-provider" style="min-width: 120px;">
                            <option value="ollama">ollama</option>
                            <option value="openai">openai</option>
                            <option value="deepseek">deepseek</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label for="human-model" style="margin: 0;">æ¨¡å‹:</label>
                        <select id="human-model" style="min-width: 250px;">
                            <option value="qwen3:14b">qwen3:14b</option>
                            <option value="llama2:7b">llama2:7b</option>
                            <option value="mistral:7b">mistral:7b</option>
                            <option value="gemma:2b">gemma:2b</option>
                            <option value="deepseek-v2:16b">deepseek-v2:16b</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label for="human-temperature" style="margin: 0;">æ¸©åº¦:</label>
                        <input type="range" id="human-temperature" min="0.0" max="2.0" step="0.1" value="0.8" style="width: 150px;">
                        <span id="human-temperature-value" style="width: 40px; text-align: center;">0.8</span>
                    </div>
                </div>
            </div>
            
            <!-- èŠå¤©å†å²åŒºåŸŸ -->
            <div style="margin-bottom: 20px;">
                <h3 style="margin-top: 0; margin-bottom: 15px;">èŠå¤©å†å²</h3>
                <div class="chat-history" id="humanChatHistory" style="height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px; padding: 15px; background-color: #ffffff;"></div>
            </div>
            
            <!-- èŠå¤©è¾“å…¥åŒºåŸŸ -->
            <div class="chat-input-group" style="margin-bottom: 20px;">
                <h3 style="margin-top: 0; margin-bottom: 15px;">è¾“å…¥</h3>
                <textarea id="human-message" placeholder="è¾“å…¥æ¶ˆæ¯ï¼ŒæŒ‰å›è½¦å‘é€ï¼ŒShift+å›è½¦æ¢è¡Œ..." style="width: 100%; min-height: 60px; max-height: 150px; resize: vertical; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;"></textarea>
            </div>
            
            <!-- èŠå¤©æ§åˆ¶åŒºåŸŸ -->
            <div class="chat-control-group" style="background-color: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef;">
                <div class="button-group" style="display: flex; gap: 10px;">
                    <button id="sendHumanMessage" class="btn-primary">å‘é€æ¶ˆæ¯</button>
                    <button id="saveChatHistory" class="btn-secondary">ä¿å­˜å†å²</button>
                    <button id="loadChatHistory" class="btn-secondary">åŠ è½½å†å²</button>
                    <button id="exportChatPdf" class="btn-secondary">å¯¼å‡ºPDF</button>
                    <button id="clearHumanChat" class="btn-secondary" style="margin-left: auto;">æ¸…ç©ºå¯¹è¯</button>
                </div>
            </div>
        </div>
        
        <div id="debate-tab" class="tab-content">
            <div class="form-group">
                <label for="debate-topic">è¾©è®ºä¸»é¢˜</label>
                <input type="text" id="debate-topic" placeholder="è¯·è¾“å…¥è¾©è®ºä¸»é¢˜">
            </div>
            
            <div class="config-row">
                <div class="config-col">
                    <h3>æ­£æ–¹AI</h3>
                    <div class="form-group">
                        <label for="debate-api1">æ¨¡å‹æœåŠ¡å•†</label>
                        <select id="debate-api1">
                            <option value="ollama">ollama</option>
                            <option value="openai">openai</option>
                            <option value="deepseek">deepseek</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="debate-model1">æ¨¡å‹</label>
                        <select id="debate-model1">
                            <option value="qwen3:14b">qwen3:14b</option>
                            <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                            <option value="gpt-4">gpt-4</option>
                            <option value="deepseek-chat">deepseek-chat</option>
                        </select>
                    </div>
                </div>
                
                <div class="config-col">
                    <h3>åæ–¹AI</h3>
                    <div class="form-group">
                        <label for="debate-api2">æ¨¡å‹æœåŠ¡å•†</label>
                        <select id="debate-api2">
                            <option value="ollama">ollama</option>
                            <option value="openai">openai</option>
                            <option value="deepseek">deepseek</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="debate-model2">æ¨¡å‹</label>
                        <select id="debate-model2">
                            <option value="deepseek-r1:14b">deepseek-r1:14b</option>
                            <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                            <option value="gpt-4">gpt-4</option>
                            <option value="deepseek-chat">deepseek-chat</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="params-grid">
                <div class="param-control">
                    <label for="debate-rounds">è¾©è®ºè½®æ•°</label>
                    <input type="range" id="debate-rounds" min="1" max="20" value="5" oninput="document.getElementById('debate-rounds-value').textContent = this.value">
                    <span id="debate-rounds-value" class="param-value">5</span>
                </div>
                
                <div class="param-control">
                    <label for="debate-timeLimit">æ—¶é—´é™åˆ¶(ç§’)</label>
                    <input type="range" id="debate-timeLimit" min="0" max="3600" step="30" value="0" oninput="document.getElementById('debate-timeLimit-value').textContent = this.value === '0' ? 'æ— é™åˆ¶' : this.value">
                    <span id="debate-timeLimit-value" class="param-value">æ— é™åˆ¶</span>
                </div>
                
                <div class="param-control">
                    <label for="debate-temperature">æ¸©åº¦</label>
                    <input type="range" id="debate-temperature" min="0" max="2" step="0.1" value="0.8" oninput="document.getElementById('debate-temperature-value').textContent = this.value">
                    <span id="debate-temperature-value" class="param-value">0.8</span>
                </div>
            </div>
            
            <div class="status-bar" id="debate-status">å°±ç»ª</div>
            
            <div class="chat-history" id="debateHistory"></div>
            
            <div class="button-group">
                <button id="exportDebatePdf" class="btn-secondary">å¯¼å‡ºPDF</button>
                <button id="startDebate" class="btn-primary">å¼€å§‹è¾©è®º</button>
                <button id="stopDebate" class="btn-danger" disabled>åœæ­¢è¾©è®º</button>
            </div>
        </div>
        
        <div id="settings-tab" class="tab-content">
            <div class="api-settings">
                <div class="api-group">
                    <h3>ç³»ç»Ÿæç¤ºè¯è®¾ç½®</h3>
                    <div class="form-group">
                        <label for="chatSystemPrompt">èŠå¤©ç³»ç»Ÿæç¤ºè¯</label>
                        <textarea id="chatSystemPrompt" placeholder="è¯·è¾“å…¥èŠå¤©æ¨¡å¼çš„ç³»ç»Ÿæç¤ºè¯">ä½ æ˜¯ä¸€ä¸ªå‚ä¸è®¨è®ºçš„AIåŠ©æ‰‹ã€‚è¯·æ ¹æ®æ”¶åˆ°çš„å†…å®¹è¿›è¡Œå›åº”ï¼Œè¨€ç®€æ„èµ…ï¼Œåªå›ç­”ç›¸å…³çš„é—®é¢˜ï¼Œä¸è¦æ‰©å±•ï¼Œå›ç­”è¶Šç®€æ´è¶Šå¥½ã€‚</textarea>
                    </div>
                    <div class="form-group">
                        <label for="discussionSystemPrompt">è®¨è®ºç³»ç»Ÿæç¤ºè¯</label>
                        <textarea id="discussionSystemPrompt" placeholder="è¯·è¾“å…¥è®¨è®ºæ¨¡å¼çš„ç³»ç»Ÿæç¤ºè¯"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="discussionAI1SystemPrompt">è®¨è®ºAI1ç³»ç»Ÿæç¤ºè¯</label>
                        <textarea id="discussionAI1SystemPrompt" placeholder="è¯·è¾“å…¥è®¨è®ºæ¨¡å¼ä¸­AI1çš„ç³»ç»Ÿæç¤ºè¯"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="discussionAI2SystemPrompt">è®¨è®ºAI2ç³»ç»Ÿæç¤ºè¯</label>
                        <textarea id="discussionAI2SystemPrompt" placeholder="è¯·è¾“å…¥è®¨è®ºæ¨¡å¼ä¸­AI2çš„ç³»ç»Ÿæç¤ºè¯"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="debateSystemPrompt">è¾©è®ºç³»ç»Ÿæç¤ºè¯</label>
                        <textarea id="debateSystemPrompt" placeholder="è¯·è¾“å…¥è¾©è®ºæ¨¡å¼çš„ç³»ç»Ÿæç¤ºè¯"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="debateAI1SystemPrompt">è¾©è®ºæ­£æ–¹AIæç¤ºè¯</label>
                        <textarea id="debateAI1SystemPrompt" placeholder="è¯·è¾“å…¥è¾©è®ºæ¨¡å¼ä¸­æ­£æ–¹AIçš„ç³»ç»Ÿæç¤ºè¯"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="debateAI2SystemPrompt">è¾©è®ºåæ–¹AIæç¤ºè¯</label>
                        <textarea id="debateAI2SystemPrompt" placeholder="è¯·è¾“å…¥è¾©è®ºæ¨¡å¼ä¸­åæ–¹AIçš„ç³»ç»Ÿæç¤ºè¯"></textarea>
                    </div>
                </div>
                
                <div class="api-group">
                    <h3>OpenAI APIè®¾ç½®</h3>
                    <div class="form-group">
                        <label for="openaiBaseUrl">APIåŸºç¡€URL</label>
                        <input type="text" id="openaiBaseUrl" value="https://api.openai.com/v1" placeholder="è¯·è¾“å…¥OpenAI APIåŸºç¡€URL">
                    </div>
                    <div class="form-group">
                        <label for="openaiKey">APIå¯†é’¥</label>
                        <input type="password" id="openaiKey" placeholder="è¯·è¾“å…¥OpenAI APIå¯†é’¥">
                        <div class="show-key" onclick="togglePassword('openaiKey')">æ˜¾ç¤ºå¯†é’¥</div>
                    </div>
                </div>
                
                <div class="api-group">
                    <h3>DeepSeek APIè®¾ç½®</h3>
                    <div class="form-group">
                        <label for="deepseekBaseUrl">APIåŸºç¡€URL</label>
                        <input type="text" id="deepseekBaseUrl" value="https://api.deepseek.com/v1" placeholder="è¯·è¾“å…¥DeepSeek APIåŸºç¡€URL">
                    </div>
                    <div class="form-group">
                        <label for="deepseekKey">APIå¯†é’¥</label>
                        <input type="password" id="deepseekKey" placeholder="è¯·è¾“å…¥DeepSeek APIå¯†é’¥">
                        <div class="show-key" onclick="togglePassword('deepseekKey')">æ˜¾ç¤ºå¯†é’¥</div>
                    </div>
                </div>
                
                <div class="api-group">
                    <h3>Ollama APIè®¾ç½®</h3>
                    <div class="form-group">
                        <label for="ollamaUrl">APIåŸºç¡€URL</label>
                        <input type="text" id="ollamaUrl" placeholder="è¯·è¾“å…¥Ollama APIåŸºç¡€URL" value="http://ai.corp.nonead.com:11434">
                    </div>
                    <div class="form-group">
                        <label for="ollamaKey">APIå¯†é’¥</label>
                        <input type="password" id="ollamaKey" placeholder="è¯·è¾“å…¥Ollama APIå¯†é’¥" value="Ollama">
                        <div class="show-key" onclick="togglePassword('ollamaKey')">æ˜¾ç¤ºå¯†é’¥</div>
                    </div>
                    <div class="form-group">
                        <label>Ollamaæ¨¡å‹æ¸…å•</label>
                        <button id="fetchOllamaModels" class="btn-secondary">è·å–æ¨¡å‹æ¸…å•</button>
                        <div id="ollamaModelsList" class="models-list"></div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button id="saveSettings" class="btn-primary">ä¿å­˜è®¾ç½®</button>
                </div>
            </div>
        </div>
        
        <div id="history-tab" class="tab-content">
            <div class="history-header">
                <h3>èŠå¤©å†å²ç®¡ç†</h3>
                <div class="button-group">
                    <button id="refreshHistory" class="btn-secondary">åˆ·æ–°å†å²</button>
                    <button id="deleteSelectedHistory" class="btn-danger">åˆ é™¤é€‰ä¸­</button>
                    <button id="clearAllHistory" class="btn-danger">æ¸…ç©ºå†å²</button>
                </div>
            </div>
            
            <div class="history-container">
                <!-- å†å²åˆ—è¡¨ï¼ˆä¸Šéƒ¨åˆ†ï¼‰ -->
                <div class="history-list-section" style="height: 300px; overflow-y: auto; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
                    <table id="historyTable" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: #f8f9fa;">
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #ddd;"><input type="checkbox" id="selectAllHistory"></th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #ddd;">æ—¶é—´</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #ddd;">æ¨¡å‹</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 2px solid #ddd;">æ ‡é¢˜</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <!-- å†å²è®°å½•è¡Œå°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                        </tbody>
                    </table>
                </div>
                
                <!-- å†å²è¯¦æƒ…ï¼ˆä¸‹éƒ¨åˆ†ï¼‰ -->
                <div class="history-detail-section" style="height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: #fafafa;">
                    <div id="historyDetail">
                        <p style="text-align: center; color: #666;">è¯·é€‰æ‹©ä¸€æ¡å†å²è®°å½•æŸ¥çœ‹è¯¦æƒ…</p>
                    </div>
                    
                    <div class="button-group" style="margin-top: 15px;">
                        <button id="exportHistory" class="btn-secondary">å¯¼å‡ºå†å²</button>
                        <button id="deleteCurrentHistory" class="btn-danger">åˆ é™¤å½“å‰å†å²</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="batch-tab" class="tab-content">
            <div class="form-group">
                <h3>æ‰¹é‡å¤„ç†é…ç½®</h3>
            </div>
            
            <!-- æ‰¹é‡ç±»å‹é€‰æ‹© -->
            <div class="api-group" style="margin-bottom: 20px; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px;">
                <h4>æ‰¹é‡ç±»å‹é€‰æ‹©</h4>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <div>
                        <input type="radio" id="batch-discussion" name="batch-type" checked>
                        <label for="batch-discussion">è®¨è®º</label>
                    </div>
                    <div>
                        <input type="radio" id="batch-debate" name="batch-type">
                        <label for="batch-debate">è¾©è®º</label>
                    </div>
                </div>
            </div>
            
            <!-- æ‰¹é‡ä»»åŠ¡è¾“å…¥ -->
            <div class="api-group" style="margin-bottom: 20px; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h4>æ‰¹é‡ä»»åŠ¡è¾“å…¥</h4>
                    <div style="display: flex; gap: 10px;">
                        <button id="clear-tasks" class="btn-secondary" style="padding: 6px 12px; font-size: 14px;">æ¸…ç©º</button>
                        <div id="task-count" style="font-size: 14px; color: #666;">ä»»åŠ¡æ•°é‡: 0</div>
                    </div>
                </div>
                <textarea id="batch-tasks" placeholder="è¯·è¾“å…¥æ‰¹é‡ä»»åŠ¡ï¼Œæ¯è¡Œä¸€ä¸ªä»»åŠ¡..." style="width: 100%; min-height: 150px; margin-top: 10px;"></textarea>
            </div>
            
            <!-- AIé…ç½®åŒºåŸŸ -->
            <div class="api-group" style="margin-bottom: 20px; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px;">
                <h4>AIæ¨¡å‹é…ç½®</h4>
                
                <!-- AI1é…ç½® -->
                <div style="background-color: #f7fbff; border: 1px solid #e3f2fd; border-radius: 6px; padding: 10px; margin-bottom: 15px;">
                    <h5 id="batch-ai1-label">å­¦è€… AI1:</h5>
                    <div class="config-row" style="margin-top: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <label style="width: 100px;">æ¨¡å‹æä¾›å•†:</label>
                            <select id="batch-ai1-api" style="width: 150px;">
                                <option value="ollama">ollama</option>
                                <option value="openai">openai</option>
                                <option value="deepseek">deepseek</option>
                            </select>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="width: 100px;">æ¨¡å‹:</label>
                            <select id="batch-ai1-model" style="width: 250px;">
                                <option value="qwen3:14b">qwen3:14b</option>
                                <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                                <option value="gpt-4">gpt-4</option>
                                <option value="deepseek-chat">deepseek-chat</option>
                                <option value="llama2">llama2</option>
                                <option value="mistral">mistral</option>
                                <option value="gemma">gemma</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- AI2é…ç½® -->
                <div style="background-color: #fcf8ff; border: 1px solid #f3e5f5; border-radius: 6px; padding: 10px; margin-bottom: 15px;">
                    <h5 id="batch-ai2-label">å­¦è€… AI2:</h5>
                    <div class="config-row" style="margin-top: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <label style="width: 100px;">æ¨¡å‹æä¾›å•†:</label>
                            <select id="batch-ai2-api" style="width: 150px;">
                                <option value="ollama">ollama</option>
                                <option value="openai">openai</option>
                                <option value="deepseek">deepseek</option>
                            </select>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="width: 100px;">æ¨¡å‹:</label>
                            <select id="batch-ai2-model" style="width: 250px;">
                                <option value="deepseek-r1:14b">deepseek-r1:14b</option>
                                <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                                <option value="gpt-4">gpt-4</option>
                                <option value="deepseek-chat">deepseek-chat</option>
                                <option value="llama2">llama2</option>
                                <option value="mistral">mistral</option>
                                <option value="gemma">gemma</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- AI3é…ç½® -->
                <div id="batch-ai3-box" style="background-color: #f1f8e9; border: 1px solid #e8f5e8; border-radius: 6px; padding: 10px;">
                    <h5 id="batch-ai3-label">ä¸“å®¶ AI3:</h5>
                    <div class="config-row" style="margin-top: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <label style="width: 100px;">æ¨¡å‹æä¾›å•†:</label>
                            <select id="batch-ai3-api" style="width: 150px;">
                                <option value="ollama">ollama</option>
                                <option value="openai">openai</option>
                                <option value="deepseek">deepseek</option>
                            </select>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <label style="width: 100px;">æ¨¡å‹:</label>
                            <select id="batch-ai3-model" style="width: 250px;">
                                <option value="qwen3:14b">qwen3:14b</option>
                                <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                                <option value="gpt-4">gpt-4</option>
                                <option value="deepseek-chat">deepseek-chat</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å‚æ•°é…ç½® -->
            <div class="api-group" style="margin-bottom: 20px; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px;">
                <h4>å¤„ç†å‚æ•°</h4>
                <div class="params-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 15px;">
                    <!-- è½®æ•° -->
                    <div>
                        <label for="batch-rounds">è½®æ•°:</label>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                            <input type="range" id="batch-rounds" min="1" max="20" value="5" oninput="document.getElementById('batch-rounds-value').textContent = this.value">
                            <span id="batch-rounds-value">5</span>
                        </div>
                    </div>
                    
                    <!-- æ—¶é—´é™åˆ¶ -->
                    <div>
                        <label for="batch-time-limit">æ—¶é—´é™åˆ¶(ç§’):</label>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                            <input type="range" id="batch-time-limit" min="0" max="3600" step="30" value="0" oninput="document.getElementById('batch-time-limit-value').textContent = this.value === '0' ? 'æ— é™åˆ¶' : this.value">
                            <span id="batch-time-limit-value">æ— é™åˆ¶</span>
                        </div>
                    </div>
                    
                    <!-- æ¸©åº¦ -->
                    <div>
                        <label for="batch-temperature">æ¸©åº¦:</label>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                            <input type="range" id="batch-temperature" min="0" max="2" step="0.1" value="0.8" oninput="document.getElementById('batch-temperature-value').textContent = this.value">
                            <span id="batch-temperature-value">0.8</span>
                        </div>
                    </div>
                    
                    <!-- å¹¶å‘æ•° -->
                    <div>
                        <label for="batch-concurrency">å¹¶å‘æ•°:</label>
                        <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                            <input type="range" id="batch-concurrency" min="1" max="5" value="2" oninput="document.getElementById('batch-concurrency-value').textContent = this.value">
                            <span id="batch-concurrency-value">2</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- çŠ¶æ€æ˜¾ç¤º -->
            <div class="status-bar" id="batch-status" style="margin-bottom: 20px;">å°±ç»ª</div>
            
            <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
            <div class="api-group" style="margin-bottom: 20px; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h4>å¤„ç†ç»“æœ</h4>
                    <button id="clear-batch-results" class="btn-secondary" style="padding: 6px 12px; font-size: 14px;">æ¸…ç©ºç»“æœ</button>
                </div>
                <div id="batch-results" class="chat-history" style="height: 400px; background-color: #fafafa; border: 1px solid #ddd; border-radius: 4px; padding: 15px; overflow-y: auto;"></div>
            </div>
            
            <!-- æ§åˆ¶æŒ‰é’® -->
            <div class="button-group" style="display: flex; gap: 10px;">
                <button id="load-tasks" class="btn-secondary">åŠ è½½ä»»åŠ¡</button>
                <button id="save-results" class="btn-secondary">ä¿å­˜ç»“æœ</button>
                <button id="save-batch-history" class="btn-secondary">ä¿å­˜å†å²</button>
                <button id="export-batch-pdf" class="btn-secondary">å¯¼å‡ºPDF</button>
                <div style="flex-grow: 1;"></div>
                <button id="start-batch" class="btn-primary">å¼€å§‹æ‰¹é‡å¤„ç†</button>
                <button id="stop-batch" class="btn-danger" disabled>åœæ­¢å¤„ç†</button>
            </div>
        </div>
        
        <div id="about-tab" class="tab-content">
            <div class="about-content" style="text-align: center; padding: 20px;">
                <img src="src/images/NONEAD_ai.png" alt="NONEAD AI Logo" class="logo" style="max-width: 200px; margin-bottom: 20px;">
                <h2>AIå¯¹è¯ç³»ç»Ÿ</h2>
                <p style="margin: 10px 0; font-size: 16px;">ç‰ˆæœ¬: 0.1.5</p>
                <p style="margin: 10px 0; font-size: 16px;">å¼€å‘å•ä½: NONEAD Corporation</p>
                <p style="margin: 10px 0; font-size: 16px;">è”ç³»æ–¹å¼: support@nonead.com</p>
                <div style="margin-top: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                    <h3>åŠŸèƒ½è¯´æ˜</h3>
                    <ul style="list-style-type: none; padding: 0; margin-top: 15px;">
                        <li style="margin: 10px 0; font-size: 14px;">ğŸ’¬ æ”¯æŒä¸AIè¿›è¡Œå•èŠ</li>
                        <li style="margin: 10px 0; font-size: 14px;">ğŸ”„ æ”¯æŒAIä¹‹é—´çš„è®¨è®ºæ¨¡å¼</li>
                        <li style="margin: 10px 0; font-size: 14px;">âš–ï¸ æ”¯æŒAIä¹‹é—´çš„è¾©è®ºæ¨¡å¼</li>
                        <li style="margin: 10px 0; font-size: 14px;">ğŸ“Š æ”¯æŒæ‰¹é‡å¤„ç†å¤šä¸ªè®¨è®ºä¸»é¢˜</li>
                        <li style="margin: 10px 0; font-size: 14px;">ğŸ“ æ”¯æŒèŠå¤©å†å²ç®¡ç†</li>
                        <li style="margin: 10px 0; font-size: 14px;">ğŸ”§ æ”¯æŒå¤šç§APIæœåŠ¡å•†é…ç½®</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        function switchTab(tabId, event) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(function(content) {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»
            document.querySelectorAll('.tab-button').forEach(function(button) {
                button.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            const tabElement = document.getElementById(tabId);
            if (tabElement) {
                tabElement.classList.add('active');
            }
            
            // ä¸ºç‚¹å‡»çš„æŒ‰é’®æ·»åŠ activeç±»
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }
        
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            if (input) {
                input.type = input.type === 'password' ? 'text' : 'password';
            }
        }
        
        // æ‰¹é‡å¤„ç†ç›¸å…³åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            // æ‰¹é‡ç±»å‹åˆ‡æ¢å¤„ç†
            const batchTypeRadios = document.querySelectorAll('input[name="batch-type"]');
            batchTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    updateBatchTypeLabels();
                });
            });
            
            // æ›´æ–°AIæ ‡ç­¾å’Œæ ·å¼
            function updateBatchTypeLabels() {
                const isDebate = document.getElementById('batch-debate').checked;
                const ai1Label = document.getElementById('batch-ai1-label');
                const ai2Label = document.getElementById('batch-ai2-label');
                const ai3Label = document.getElementById('batch-ai3-label');
                const ai3Box = document.getElementById('batch-ai3-box');
                
                if (isDebate) {
                    ai1Label.textContent = 'æ­£æ–¹ AI1:';
                    ai2Label.textContent = 'åæ–¹ AI2:';
                    ai3Label.textContent = 'è£åˆ¤ AI3:';
                    ai3Box.style.backgroundColor = '#f9fbe7';
                    ai3Box.style.borderColor = '#fff3e0';
                } else {
                    ai1Label.textContent = 'å­¦è€… AI1:';
                    ai2Label.textContent = 'å­¦è€… AI2:';
                    ai3Label.textContent = 'ä¸“å®¶ AI3:';
                    ai3Box.style.backgroundColor = '#f1f8e9';
                    ai3Box.style.borderColor = '#e8f5e8';
                }
            }
            
            // ä»»åŠ¡è¾“å…¥æ–‡æœ¬å˜åŒ–æ—¶æ›´æ–°ä»»åŠ¡æ•°é‡
            const batchTasks = document.getElementById('batch-tasks');
            const taskCount = document.getElementById('task-count');
            
            batchTasks.addEventListener('input', function() {
                const tasks = this.value.trim();
                const taskList = tasks.split('\n').filter(task => task.trim());
                taskCount.textContent = `ä»»åŠ¡æ•°é‡: ${taskList.length}`;
            });
            
            // æ¸…ç©ºä»»åŠ¡
            const clearTasksBtn = document.getElementById('clear-tasks');
            clearTasksBtn.addEventListener('click', function() {
                batchTasks.value = '';
                taskCount.textContent = 'ä»»åŠ¡æ•°é‡: 0';
            });
            
            // æ¸…ç©ºç»“æœ
            const clearResultsBtn = document.getElementById('clear-batch-results');
            const batchResults = document.getElementById('batch-results');
            
            clearResultsBtn.addEventListener('click', function() {
                batchResults.innerHTML = '';
            });
            
            // å¼€å§‹æ‰¹é‡å¤„ç†
            const startBatchBtn = document.getElementById('start-batch');
            const stopBatchBtn = document.getElementById('stop-batch');
            const batchStatus = document.getElementById('batch-status');
            
            let isProcessing = false;
            
            startBatchBtn.addEventListener('click', function() {
                if (isProcessing) return;
                
                const tasks = batchTasks.value.trim();
                if (!tasks) {
                    alert('è¯·è¾“å…¥æˆ–åŠ è½½æ‰¹é‡ä»»åŠ¡');
                    return;
                }
                
                isProcessing = true;
                startBatchBtn.disabled = true;
                stopBatchBtn.disabled = false;
                batchStatus.textContent = 'æ­£åœ¨è¿›è¡Œæ‰¹é‡å¤„ç†...';
                
                // è§£æä»»åŠ¡åˆ—è¡¨
                const taskList = tasks.split('\n').filter(task => task.trim());
                const totalTasks = taskList.length;
                
                // æ˜¾ç¤ºæ‰¹é‡å¤„ç†å¼€å§‹ä¿¡æ¯
                appendBatchResult(`æ‰¹é‡${document.getElementById('batch-debate').checked ? 'è¾©è®º' : 'è®¨è®º'}å¤„ç†å¼€å§‹`, 'system');
                
                // æ˜¾ç¤ºé…ç½®ä¿¡æ¯
                const configContent = `**æ‰¹é‡${document.getElementById('batch-debate').checked ? 'è¾©è®º' : 'è®¨è®º'}å¤„ç†é…ç½®**\n- AI1 API: ${document.getElementById('batch-ai1-api').value}\n- AI1 æ¨¡å‹: ${document.getElementById('batch-ai1-model').value}\n- AI2 API: ${document.getElementById('batch-ai2-api').value}\n- AI2 æ¨¡å‹: ${document.getElementById('batch-ai2-model').value}\n- ${document.getElementById('batch-ai3-label').textContent.replace(':', '')} API: ${document.getElementById('batch-ai3-api').value}\n- ${document.getElementById('batch-ai3-label').textContent.replace(':', '')} æ¨¡å‹: ${document.getElementById('batch-ai3-model').value}\n- æ¸©åº¦: ${document.getElementById('batch-temperature').value}\n- è½®æ•°: ${document.getElementById('batch-rounds').value}\n- é™æ—¶: ${document.getElementById('batch-time-limit').value}ç§’\n- å¹¶å‘æ•°: ${document.getElementById('batch-concurrency').value}\n- æ€»ä»»åŠ¡æ•°: ${totalTasks}`;
                appendBatchResult(configContent, 'info');
                appendBatchResult('='.repeat(60), 'system');
                
                // æ¨¡æ‹Ÿæ‰¹é‡å¤„ç†è¿‡ç¨‹
                let completedTasks = 0;
                let failedTasks = 0;
                
                const processNextTask = (index) => {
                    if (index >= totalTasks || !isProcessing) {
                        // å¤„ç†å®Œæˆ
                        const endTime = new Date().toLocaleString();
                        appendBatchResult('='.repeat(60), 'system');
                        appendBatchResult(`**æ‰¹é‡${document.getElementById('batch-debate').checked ? 'è¾©è®º' : 'è®¨è®º'}å¤„ç†å®Œæˆ**\n- æ€»ä»»åŠ¡æ•°: ${totalTasks}\n- æˆåŠŸ: ${completedTasks}\n- å¤±è´¥: ${failedTasks}`, 'success');
                        
                        isProcessing = false;
                        startBatchBtn.disabled = false;
                        stopBatchBtn.disabled = true;
                        batchStatus.textContent = 'å°±ç»ª';
                        return;
                    }
                    
                    const task = taskList[index];
                    batchStatus.textContent = `æ­£åœ¨å¤„ç†ç¬¬ ${index+1}/${totalTasks} ä¸ªä»»åŠ¡`;
                    
                    // æ˜¾ç¤ºä»»åŠ¡ä¿¡æ¯
                    appendBatchResult(`**ä»»åŠ¡ ${index+1}/${totalTasks}**\n${task}`, 'task');
                    
                    // æ¨¡æ‹Ÿä»»åŠ¡å¤„ç†
                    setTimeout(() => {
                        try {
                            // æ¨¡æ‹Ÿå¤„ç†ç»“æœ
                            const result = `**ä»»åŠ¡ ${index+1} ç»“æœ**\nè¿™æ˜¯æ¨¡æ‹Ÿçš„${document.getElementById('batch-debate').checked ? 'è¾©è®º' : 'è®¨è®º'}ç»“æœï¼Œå®é™…å®ç°æ—¶ä¼šè°ƒç”¨APIè¿›è¡Œå¤„ç†ã€‚\n\nAI1: è¿™æ˜¯AI1çš„å›å¤å†…å®¹ã€‚\n\nAI2: è¿™æ˜¯AI2çš„å›å¤å†…å®¹ã€‚\n\n${document.getElementById('batch-ai3-label').textContent.replace(':', '')}: è¿™æ˜¯${document.getElementById('batch-ai3-label').textContent.replace(':', '')}çš„æ€»ç»“å†…å®¹ã€‚`;
                            appendBatchResult(result, 'result');
                            appendBatchResult('-'.repeat(50), 'system');
                            completedTasks++;
                        } catch (error) {
                            appendBatchResult(`**ä»»åŠ¡ ${index+1} å¤±è´¥**\né”™è¯¯ä¿¡æ¯: ${error.message}`, 'error');
                            appendBatchResult('-'.repeat(50), 'system');
                            failedTasks++;
                        }
                        
                        // å¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡
                        processNextTask(index + 1);
                    }, 1000);
                };
                
                // å¼€å§‹å¤„ç†ç¬¬ä¸€ä¸ªä»»åŠ¡
                processNextTask(0);
            });
            
            // åœæ­¢æ‰¹é‡å¤„ç†
            stopBatchBtn.addEventListener('click', function() {
                isProcessing = false;
                batchStatus.textContent = 'æ‰¹é‡å¤„ç†å·²åœæ­¢';
            });
            
            // å‘æ‰¹é‡ç»“æœåŒºåŸŸæ·»åŠ å†…å®¹
            function appendBatchResult(content, messageType) {
                const resultDiv = document.getElementById('batch-results');
                const messageDiv = document.createElement('div');
                
                // æ ¹æ®æ¶ˆæ¯ç±»å‹è®¾ç½®æ ·å¼
                const typeConfig = {
                    'info': { className: 'info-message', color: '#0d47a1' },
                    'success': { className: 'success-message', color: '#2e7d32' },
                    'error': { className: 'error-message', color: '#c62828' },
                    'task': { className: 'task-message', color: '#ef6c00' },
                    'result': { className: 'result-message', color: '#6a1b9a' },
                    'system': { className: 'system-message', color: '#666' }
                };
                
                const config = typeConfig[messageType] || typeConfig['info'];
                messageDiv.className = `message ${config.className}`;
                
                // ç”ŸæˆHTMLå†…å®¹
                const timestamp = new Date().toLocaleString();
                messageDiv.innerHTML = `<div class="message-header" style="color: ${config.color};">æ‰¹é‡å¤„ç† - ${timestamp}</div><div class="message-content">${marked.parse(content)}</div>`;
                
                resultDiv.appendChild(messageDiv);
                resultDiv.scrollTop = resultDiv.scrollHeight; // æ»šåŠ¨åˆ°åº•éƒ¨
            }
            
            // åŠ è½½ä»»åŠ¡æ–‡ä»¶
            const loadTasksBtn = document.getElementById('load-tasks');
            loadTasksBtn.addEventListener('click', function() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.txt';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            batchTasks.value = event.target.result;
                            const taskList = batchTasks.value.trim().split('\n').filter(task => task.trim());
                            taskCount.textContent = `ä»»åŠ¡æ•°é‡: ${taskList.length}`;
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            });
            
            // ä¿å­˜ç»“æœåˆ°æ–‡ä»¶
            const saveResultsBtn = document.getElementById('save-results');
            saveResultsBtn.addEventListener('click', function() {
                const results = batchResults.innerText;
                if (!results) {
                    alert('ç»“æœä¸ºç©ºï¼Œæ— æ³•ä¿å­˜');
                    return;
                }
                
                const blob = new Blob([results], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `batch_results_${new Date().toISOString().slice(0, 10)}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
            
            // å¯¼å‡ºPDFåŠŸèƒ½ï¼ˆæ¨¡æ‹Ÿï¼‰
            const exportPdfBtn = document.getElementById('export-batch-pdf');
            exportPdfBtn.addEventListener('click', function() {
                alert('PDFå¯¼å‡ºåŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­');
            });
            
            // ä¿å­˜å†å²åŠŸèƒ½ï¼ˆæ¨¡æ‹Ÿï¼‰
            const saveHistoryBtn = document.getElementById('save-batch-history');
            saveHistoryBtn.addEventListener('click', function() {
                alert('å†å²ä¿å­˜åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­');
            });
        });
    </script>
    
    <!-- ç™»å½•åŠŸèƒ½è„šæœ¬ -->
    <script>
        // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
        const token = localStorage.getItem('token');
        if (token) {
            // å·²ç™»å½•ï¼Œéšè—ç™»å½•æ¨¡æ€æ¡†
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                loginModal.style.display = 'none';
            }
        }
        
        // ç™»å½•è¡¨å•æäº¤äº‹ä»¶
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginError');
            
            if (!username || !password) {
                errorElement.textContent = 'è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ';
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8000/api/token', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        username: username,
                        password: password
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    localStorage.setItem('token', data.access_token);
                    // éšè—ç™»å½•æ¨¡æ€æ¡†
                    const loginModal = document.getElementById('loginModal');
                    if (loginModal) {
                        loginModal.style.display = 'none';
                    }
                } else {
                    const errorData = await response.json();
                    errorElement.textContent = errorData.detail || 'ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç ';
                }
            } catch (error) {
                console.error('ç™»å½•å¤±è´¥:', error);
                errorElement.textContent = 'ç™»å½•å¤±è´¥ï¼ŒæœåŠ¡å™¨è¿æ¥é”™è¯¯';
            }
        });
        
        // æ³¨å†ŒæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById('registerBtn').addEventListener('click', () => {
            alert('æ³¨å†ŒåŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­');
        });
    </script>
    
    <!-- å¼•å…¥ç¬¬ä¸‰æ–¹åº“ -->
    <script src="js/marked.min.js"></script>
</body>
</html>